<?xml version="1.0" encoding="UTF-8"?>

<workflow-definition xmlns="urn:liferay.com:liferay-workflow_7.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="urn:liferay.com:liferay-workflow_7.0.0 http://www.liferay.com/dtd/liferay-workflow-definition_7_0_0.xsd">
	<name>Two Factor Auth Email Notification</name>

	<description></description>
	<version>1</version>

	<state>
		<name>start</name>
		<metadata>
			<![CDATA[{"xy":[53,223]}]]>
		</metadata>
		<initial>true</initial>
		<transitions>
			<transition>
				<name>Send email notification</name>
				<target>Enter Code for verification</target>
				<default>true</default>
			</transition>
		</transitions>
	</state>
	<state>
		<name>completed</name>
		<metadata>
			<![CDATA[{"terminal":true,"xy":[653,224]}]]>
		</metadata>
		<actions>
			<action>
				<name>Approve</name>
				<description>Approve</description>
				<script>
					<![CDATA[import com.liferay.portal.kernel.workflow.WorkflowStatusManagerUtil;
	import com.liferay.portal.kernel.workflow.WorkflowConstants;

	WorkflowStatusManagerUtil.updateStatus(WorkflowConstants.getLabelStatus("approved"), workflowContext);]]>
				</script>
				<script-language>groovy</script-language>
				<execution-type>onEntry</execution-type>
			</action>
		</actions>
	</state>
	<task>
		<name>Enter Code for verification</name>
		<metadata>
			<![CDATA[{"xy":[400,209]}]]>
		</metadata>
		<actions>
			<notification>
				<name>Login Code Verification</name>
				<description>
				</description>
				<template>
					<![CDATA[
						<!DOCTYPE html>

						<html>
							<head>
								<meta content="text/html; charset=utf-8" http-equiv="Content-Type" />
								<meta content="width=device-width, initial-scale=1.0" name="viewport" />

								<title>Two Factor Authentication code for The Hub™, Bemis Customer Portal</title>

								<style type="text/css">
									@media only screen and (max-width: 480px) {
										.container {
											padding-left: 10px !important;
											padding-right: 10px !important;
											width: 100% !important;
										}
									}
								</style>
							</head>

							<body>
								<table
									border="0"
									cellpadding="0"
									cellspacing="0"
									height="100%"
									width="100%"
								>
									<tbody>
										<tr>
											<td align="center">
												<table
													border="0"
													cellpadding="0"
													cellspacing="0"
													class="container"
													height="100%"
													width="560px"
												>
													<tbody>
														<tr>
															<td
																align="left"
																valign="middle"
															>
																${portalUserName},<br/><br/>

																We have detected that you are signing into The Hub&#0153; from a new device. This can happen when you sign in for the first time on a new computer or phone, or when you have recently cleared your browsing history. <br/><br/>

																<strong>Please use this <a href="${verificationURL}" target="blank">verification link</a> and enter the verfication code below to activate your new device:</strong> <br/><br/>

																<strong>${verificationCode}</strong> <br/><br/>

																If you have any questions, please reach out to your Customer Service or Sales Representative.<br/><br/>

																The Hub™
																Bemis Customer Portal
															</td>
														</tr>
													</tbody>
												</table>
											</td>
										</tr>
									</tbody>
								</table>
							</body>
						</html>
					]]>
				</template>
				<template-language>freemarker</template-language>
				<notification-type>email</notification-type>
				<recipients>
					<assignees/>
				</recipients>
				<execution-type>onAssignment</execution-type>
			</notification>
		</actions>
		<assignments>
			<user/>
		</assignments>
		<transitions>
			<transition>
				<name>code verified</name>
				<target>completed</target>
				<default>true</default>
			</transition>
		</transitions>
	</task>
</workflow-definition>